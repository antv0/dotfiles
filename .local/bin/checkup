#!/bin/sh
# Syncs repositories and downloads updates, meant to be run as a cronjob.

ping -q -c 1 archlinux.org > /dev/null || exit

if pgrep dunst;
then notify-send "ğŸ“¦ Synchronisation des bases de donnÃ©es de paquetsâ€¦" "Recherche de mises Ã  jour de paquets...";
else echo "ğŸ“¦ Recherche de mises Ã  jour de paquets..."; fi

sudo pacman -Syyuw --noconfirm || if pgrep dunst; then notify-send "Error downloading updates.

Check your internet connection, if pacman is already running, or run update manually to see errors."; else echo "Error downloading updates.

Check your internet connection, if pacman is already running, or run update manually to see errors."; fi

if pacman -Qu | grep -v "\[ignored\]"
then
    if pgrep dunst;
    then notify-send "ğŸ Bases de donnÃ©es Sync" "Mises Ã  jour disponibles.";
    else echo "ğŸ Mises Ã  jour disponibles."; fi
else
    if pgrep dunst;
    then notify-send "ğŸ“¦ Bases de donnÃ©es Sync"  "Pas de paquets Ã  mettre Ã  jour.";
    else echo "ğŸ“¦ Pas de paquets Ã  mettre Ã  jour."; fi
fi
